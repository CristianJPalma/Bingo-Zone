<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bingo</title>
    <script>
                        const urlParams = new URLSearchParams(window.location.search);
                        const codigoPartida = urlParams.get('codigo');   

                        function obtenerNumerosGenerados() {
            fetch(`generar_balotas.php?codigo=${codigoPartida}`)
                .then(response => {
                    if (!response.ok) {
                        throw new Error('Error al obtener los números');
                    }
                    return response.json();
                })
                .then(data => {
                    // Verificar si hay error en la respuesta del servidor
                    if (data.error) {
                        console.error(data.error);
                        return;
                    }

                    // Mostrar los números generados en la interfaz
                    const contenedor = document.getElementById('numerosGenerados');
                    contenedor.innerHTML = ''; // Limpiar contenido previo

                    data.numeros_generados.forEach(item => {
                        const numeroElement = document.createElement('div');
                        numeroElement.textContent = `${item.letra} ${item.numero}`;
                        contenedor.appendChild(numeroElement);
                    });

                    // Mostrar el último número generado
                    if (data.nuevo_numero) {
                        const nuevoNumeroElement = document.getElementById('nuevoNumero');
                        nuevoNumeroElement.textContent = `Nuevo número: ${data.nuevo_numero.letra} ${data.nuevo_numero.numero}`;
                    }
                })
                .catch(error => {
                    console.error('Error al obtener los números generados:', error);
                });
        }

        // Llamar a la función cada 5 segundos para actualizar los números
        setInterval(obtenerNumerosGenerados, 5000);

        // Cargar los números cuando se carga la página por primera vez
        window.onload = obtenerNumerosGenerados;
    </script>
</head>
<body>
    <h1>Juego de Bingo</h1>
    <div id="nuevoNumero"></div>
    <h2>Números Generados:</h2>
    <div id="numerosGenerados"></div>
</body>
</html>